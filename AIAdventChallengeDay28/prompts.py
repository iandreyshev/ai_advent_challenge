"""Коллекция prompt-шаблонов для оптимизации LLM.

Демонстрирует влияние структуры промпта на качество ответов.
"""

# === БАЗОВЫЕ ПРОМПТЫ (без оптимизации) ===

BASIC_SYSTEM = "Ты — ассистент."

BASIC_EXTRACTION = "Извлеки данные из текста."


# === ОПТИМИЗИРОВАННЫЕ ПРОМПТЫ ===

# Детальный системный промпт с ролью и ограничениями
OPTIMIZED_SYSTEM = """Ты — эксперт по анализу текста и извлечению структурированных данных.

Твои ключевые качества:
- Точность: извлекаешь только то, что явно указано в тексте
- Структурированность: всегда возвращаешь данные в заданном формате
- Краткость: не добавляешь лишней информации

Ограничения:
- Не выдумывай данные, которых нет в тексте
- Если информация отсутствует, указывай "не указано"
- Отвечай только на русском языке"""


# Промпт для извлечения данных о товарах (задача: парсинг описаний)
EXTRACTION_BASIC = """Извлеки информацию о товаре из текста.
Текст: {text}"""

EXTRACTION_STRUCTURED = """Проанализируй описание товара и извлеки структурированные данные.

Текст для анализа:
---
{text}
---

Верни результат СТРОГО в формате JSON:
{{
    "название": "...",
    "цена": "... руб." или "не указано",
    "категория": "...",
    "характеристики": ["...", "..."],
    "наличие": "в наличии" / "под заказ" / "не указано"
}}

Важно: используй только информацию из текста, не додумывай."""


EXTRACTION_COT = """Твоя задача — извлечь структурированные данные о товаре.

Текст для анализа:
---
{text}
---

Выполни анализ пошагово:

Шаг 1: Определи название товара
Шаг 2: Найди цену (если указана)
Шаг 3: Определи категорию товара
Шаг 4: Выдели ключевые характеристики
Шаг 5: Проверь информацию о наличии

После анализа верни JSON:
{{
    "название": "...",
    "цена": "...",
    "категория": "...",
    "характеристики": [...],
    "наличие": "..."
}}"""


# === ПРОМПТЫ ДЛЯ ЗАДАЧИ СУММАРИЗАЦИИ ===

SUMMARY_BASIC = """Кратко опиши текст: {text}"""

SUMMARY_STRUCTURED = """Создай структурированное резюме текста.

Текст:
---
{text}
---

Формат ответа:
1. ГЛАВНАЯ МЫСЛЬ (1 предложение)
2. КЛЮЧЕВЫЕ ФАКТЫ (2-3 пункта)
3. ВЫВОД (1 предложение)"""


# === ПРОМПТЫ ДЛЯ КЛАССИФИКАЦИИ ===

CLASSIFY_BASIC = """Определи тональность текста (позитивная/негативная/нейтральная): {text}"""

CLASSIFY_STRUCTURED = """Проанализируй тональность и эмоции в тексте.

Текст:
---
{text}
---

Верни JSON:
{{
    "тональность": "позитивная" / "негативная" / "нейтральная",
    "уверенность": 0.0-1.0,
    "ключевые_маркеры": ["слово1", "слово2"],
    "обоснование": "краткое объяснение"
}}"""


# === ТЕСТОВЫЕ ДАННЫЕ ===

TEST_PRODUCTS = [
    """iPhone 15 Pro Max 256GB в цвете титановый чёрный.
    Процессор A17 Pro, камера 48 Мп, экран 6.7" Super Retina XDR.
    Цена: 149 990 руб. В наличии на складе.""",

    """Ноутбук для работы и учёбы. Хорошее состояние,
    батарея держит 5 часов. Отдам за 25000, торг.""",

    """Продам кроссовки Nike Air Max, размер 42.
    Новые, с бирками. Не подошёл размер.""",
]

TEST_REVIEWS = [
    "Отличный товар! Доставили быстро, качество супер. Рекомендую всем!",
    "Ужасный сервис. Ждал посылку месяц, пришла помятая. Больше не закажу.",
    "Товар соответствует описанию. Работает нормально.",
]


# === КОНФИГУРАЦИИ ПАРАМЕТРОВ ===

PARAM_CONFIGS = {
    "creative": {
        "temperature": 0.9,
        "top_p": 0.95,
        "num_predict": 500,
        "description": "Высокая креативность, разнообразные ответы"
    },
    "balanced": {
        "temperature": 0.5,
        "top_p": 0.9,
        "num_predict": 300,
        "description": "Баланс между креативностью и точностью"
    },
    "precise": {
        "temperature": 0.1,
        "top_p": 0.5,
        "num_predict": 200,
        "description": "Максимальная точность и детерминированность"
    },
    "deterministic": {
        "temperature": 0.0,
        "top_p": 1.0,
        "num_predict": 200,
        "description": "Полностью детерминированный режим"
    }
}

CONTEXT_CONFIGS = {
    "small": {
        "num_ctx": 1024,
        "description": "Маленький контекст (быстрее, меньше памяти)"
    },
    "medium": {
        "num_ctx": 2048,
        "description": "Средний контекст (баланс)"
    },
    "large": {
        "num_ctx": 4096,
        "description": "Большой контекст (для длинных текстов)"
    }
}
